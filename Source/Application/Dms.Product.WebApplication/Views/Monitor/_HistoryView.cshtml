
@model Tuple<Dms.Product.Respository.Model.MonitorViewModel, Dms.Product.Base.Model.Data>

<div class="x_content" style="color:#666666">

	<div class="center col-md-2 col-sm-12 col-xs-12" style="width: 130px;height:150px;text-align:center;">
		<img class="img-responsive" alt="" src="@Html.DisplayFor(model=>model.Item1.Customer.IMAGE)">
	</div>

	<div class="right col-md-10 col-sm-12 col-xs-12">
		<div class="form-horizontal form-label-left">
			<div asp-validation-summary="ModelOnly" class="text-danger"></div>
			<div class="clearfix">
				<label asp-for="Item1.Customer.NAME" class="control-label col-md-1 col-sm-12 col-xs-12"></label>
				<div class="col-md-1 col-sm-12 col-xs-12 ">
					<h6>@Model.Item1.Customer.NAME</h6>
				</div>

				<label asp-for="Item1.Customer.SEX" class="control-label col-md-1 col-sm-12 col-xs-12"></label>
				<div class="col-md-2 col-sm-12 col-xs-12 ">
					<h6>@Model.Item1.Customer.SEX</h6>
				</div>
				<label asp-for="Item1.Customer.AGE" class="control-label col-md-1 col-sm-12 col-xs-12"></label>
				<div class="col-md-2 col-sm-12 col-xs-12 ">
					<h6>@Model.Item1.Customer.AGE</h6>
				</div>
				<label asp-for="Item1.Customer.CARDID" class="control-label col-md-1 col-sm-12 col-xs-12"></label>
				<div class="col-md-1 col-sm-12 col-xs-12 ">
					<h6>@Model.Item1.Customer.CARDID</h6>
				</div>
			</div>

			<div class="clearfix">
				<label asp-for="Item1.Bed.CODE" class="control-label col-md-1 col-sm-3 col-xs-12"></label>
				<div class="col-md-1 col-sm-12 col-xs-12 ">
					<h6>@Model.Item1.Bed.CODE</h6>
				</div>

				<label asp-for="Item1.Bed.MATID" class="control-label col-md-1 col-sm-3 col-xs-12"></label>
				<div class="col-md-2 col-sm-12 col-xs-12 ">
					<h6 id="lable_matcode">@Model.Item1.Bed.MATID</h6>
				</div>
				<label asp-for="Item1.Customer.HISTORY" class="control-label col-md-1 col-sm-12 col-xs-12"></label>
				<div class="col-md-2 col-sm-12 col-xs-12 ">
					<h6>@Model.Item1.Customer.HISTORY</h6>
				</div>
				<label asp-for="Item1.Customer.DIAGNOSIS" class="control-label col-md-1 col-sm-12 col-xs-12"></label>
				<div class="col-md-2 col-sm-12 col-xs-12 ">
					<h6>@Model.Item1.Customer.DIAGNOSIS</h6>
				</div>
			</div>

			<div class="clearfix">

				@*创建时间*@
				<label class="control-label col-md-1 col-sm-3 col-xs-12">使用日期</label>
				<div class="col-md-1 col-sm-12 col-xs-12 ">
					<h6>@Model.Item1.MonitorDetial.Monitor.CDATE.Substring(0, 10)</h6>
				</div>

				@*护理等级*@
				<label asp-for="Item1.Customer.NURSE" class="control-label col-md-1 col-sm-3 col-xs-12"></label>
				<div class="col-md-2 col-sm-12 col-xs-12 ">
					<h6>@Model.Item1.Customer.NURSE</h6>
				</div>

				@*翻身计划*@
				<label asp-for="Item1.Customer.TURN" class="control-label col-md-1 col-sm-3 col-xs-12"></label>
				<div class="col-md-2 col-sm-12 col-xs-12 ">
					<h6>@Model.Item1.Customer.TURN</h6>
				</div>

			</div>

			@*监护时间*@
			<div class="clearfix">

				@*心率*@
				<label class="control-label col-md-1 col-sm-3 col-xs-12">心率监测</label>

				<div class="col-md-1 col-sm-12 col-xs-12 ">
					<h6><strong>@Model.Item1.MonitorDetial.HeartRange.MinValue</strong>  -<strong> @Model.Item1.MonitorDetial.HeartRange.MaxVlalue</strong> </h6>
				</div>

				<label class="control-label col-md-1 col-sm-12 col-xs-12">监护时间1</label>
				<div class="col-md-2 col-sm-12 col-xs-12 ">
					@if (Model.Item1.MonitorDetial.TimeRange1.IsEnbled)
					{<h6>
							<strong>@Model.Item1.MonitorDetial.TimeRange1.MinValue</strong>  - <strong>
								@Model.Item1.MonitorDetial.TimeRange1.MaxVlalue
							</strong>
							离床 <strong>@Model.Item1.MonitorDetial.TimeRange1.LeaveBedTime</strong>  分钟/体动 <strong>@Model.Item1.MonitorDetial.TimeRange1.MoveTime</strong>  秒
						</h6>
					}
					else
					{
						<h6>×</h6>
					}
				</div>


				<label class="control-label col-md-1 col-sm-12 col-xs-12">监护时间2</label>
				<div class="col-md-2 col-sm-12 col-xs-12 ">
					@if (Model.Item1.MonitorDetial.TimeRange2.IsEnbled)
					{<h6>
							<strong>@Model.Item1.MonitorDetial.TimeRange2.MinValue</strong>  - <strong>
								@Model.Item1.MonitorDetial.TimeRange2.MaxVlalue
							</strong>
							离床 <strong>@Model.Item1.MonitorDetial.TimeRange2.LeaveBedTime</strong>  分钟/体动 <strong>@Model.Item1.MonitorDetial.TimeRange2.MoveTime</strong>  秒
						</h6>
					}
					else
					{
						<h6>×</h6>
					}
				</div>

				<label class="control-label col-md-1 col-sm-12 col-xs-12">监护时间3</label>
				<div class="col-md-3 col-sm-12 col-xs-12 ">
					@if (Model.Item1.MonitorDetial.TimeRange3.IsEnbled)
					{<h6>
							<strong>@Model.Item1.MonitorDetial.TimeRange3.MinValue</strong>  - <strong>
								@Model.Item1.MonitorDetial.TimeRange3.MaxVlalue
							</strong>
							离床 <strong>@Model.Item1.MonitorDetial.TimeRange3.LeaveBedTime</strong>  分钟/体动 <strong>@Model.Item1.MonitorDetial.TimeRange3.MoveTime</strong>  秒
						</h6>
					}
					else
					{
						<h6>×</h6>
					}
				</div>
			</div>

			<div class="clearfix">

				@*呼吸*@
				<label class="control-label col-md-1 col-sm-3 col-xs-12">呼吸监测</label>

				<div class="col-md-1 col-sm-12 col-xs-12">
					<h6><strong>@Model.Item1.MonitorDetial.BreathRange.MinValue</strong> - <strong>@Model.Item1.MonitorDetial.BreathRange.MaxVlalue</strong> </h6>
				</div>

				<label class="control-label col-md-1 col-sm-12 col-xs-12">监护时间4</label>
				<div class="col-md-2 col-sm-12 col-xs-12">
					@if (Model.Item1.MonitorDetial.TimeRange4.IsEnbled)
					{<h6>
							<strong>@Model.Item1.MonitorDetial.TimeRange4.MinValue</strong>  - <strong>
								@Model.Item1.MonitorDetial.TimeRange4.MaxVlalue
							</strong>
							离床 <strong>@Model.Item1.MonitorDetial.TimeRange4.LeaveBedTime</strong>  分钟/体动 <strong>@Model.Item1.MonitorDetial.TimeRange4.MoveTime</strong>  秒
						</h6>
					}
					else
					{
						<h6>×</h6>
					}
				</div>
				<label class="control-label col-md-1 col-sm-12 col-xs-12">监护时间5</label>
				<div class="col-md-2 col-sm-12 col-xs-12">
					@if (Model.Item1.MonitorDetial.TimeRange5.IsEnbled)
					{<h6>
							<strong>@Model.Item1.MonitorDetial.TimeRange5.MinValue</strong>  - <strong>
								@Model.Item1.MonitorDetial.TimeRange5.MaxVlalue
							</strong>
							离床 <strong>@Model.Item1.MonitorDetial.TimeRange5.LeaveBedTime</strong>  分钟/体动 <strong>@Model.Item1.MonitorDetial.TimeRange5.MoveTime</strong>  秒
						</h6>
					}
					else
					{
						<h6>×</h6>
					}
				</div>


			</div>

		</div>
	</div>


</div>
<div class="row">
	<div class="row col-md-12 col-sm-12 col-xs-12 col-md-offset-1" style="float:right;color:black">

		@if (Model.Item2.result == null)
		{
			@*<h5 id="header-message" class="col-md-12 col-sm-12 col-xs-12">
					心率：<strong>@Html.DisplayFor(model => model.Item2.result.heartBeat.max)</strong>/<strong>@Html.DisplayFor(model => model.Item2.result.heartBeat.min)</strong>
					&nbsp;呼吸：<strong>@Html.DisplayFor(model => model.Item2.result.breath.max)</strong>/<strong>@Html.DisplayFor(model => model.Item2.result.breath.min)</strong>
					&nbsp;离床次数：<strong>@Html.DisplayFor(model => model.Item2.result.offBed.times)</strong>次
					&nbsp;离床持续时间：<strong>@Html.DisplayFor(model => model.Item2.result.offBed.time)</strong>
					&nbsp;在床持续时间：<strong>@Html.DisplayFor(model => model.Item2.result.onBedTime)</strong>
					&nbsp;体动次数：<strong>@Html.DisplayFor(model => model.Item2.result.move.times)</strong>次
					&nbsp;体动持续时间：<strong>@Html.DisplayFor(model => model.Item2.result.move.time)</strong>
					&nbsp;睡眠持续时间：<strong>@Html.DisplayFor(model => model.Item2.result.sleepTime)</strong>
					&nbsp;入睡持续时间：<strong>@Html.DisplayFor(model => model.Item2.result.sleepResult.GoToSleep.TotalTime)</strong>
					&nbsp;浅睡持续时间：<strong>@Html.DisplayFor(model => model.Item2.result.sleepResult.LightSleep.TotalTime)</strong>
					&nbsp;深睡持续时间：<strong>@Html.DisplayFor(model => model.Item2.result.sleepResult.DeepSleep.TotalTime)</strong>
				</h5>*@
		}
		else
		{
			<h5 id="header-message" class="col-md-12 col-sm-12 col-xs-12">
				心率：<strong>@Html.DisplayFor(model => model.Item2.result.heartBeat.max)</strong>/<strong>@Html.DisplayFor(model => model.Item2.result.heartBeat.min)</strong>
				&nbsp;呼吸：<strong>@Html.DisplayFor(model => model.Item2.result.breath.max)</strong>/<strong>@Html.DisplayFor(model => model.Item2.result.breath.min)</strong>
				&nbsp;离床次数：<strong>@Html.DisplayFor(model => model.Item2.result.offBed.times)</strong>次
				&nbsp;离床持续时间：<strong>@Html.DisplayFor(model => model.Item2.result.offBed.time)</strong>
				&nbsp;在床持续时间：<strong>@Html.DisplayFor(model => model.Item2.result.onBedTime)</strong>
				&nbsp;体动次数：<strong>@Html.DisplayFor(model => model.Item2.result.move.times)</strong>次
				&nbsp;体动持续时间：<strong>@Html.DisplayFor(model => model.Item2.result.move.time)</strong>
				&nbsp;睡眠持续时间：<strong>@Html.DisplayFor(model => model.Item2.result.sleepTime)</strong>
				&nbsp;入睡持续时间：<strong>@Html.DisplayFor(model => model.Item2.result.sleepResult.GoToSleep.TotalTime)</strong>
				&nbsp;浅睡持续时间：<strong>@Html.DisplayFor(model => model.Item2.result.sleepResult.LightSleep.TotalTime)</strong>
				&nbsp;深睡持续时间：<strong>@Html.DisplayFor(model => model.Item2.result.sleepResult.DeepSleep.TotalTime)</strong>
			</h5>
		}

	</div>
</div>


<div class="x_content">

	<div class="form-group" style="border-top:1px solid #337AB7;margin-top:2px"></div>
	<table id="datatable-buttons" class="table table-striped table-bordered dt-responsive nowrap" cellspacing="0" style="min-width:1800px">
		<thead>
			<tr>
				<th style="width:10px">
					序号
				</th>
				<th>
					心率
				</th>
				<th>
					呼吸
				</th>
				<th>
					体动状态
				</th>
				<th>
					睡眠状态
				</th>
				<th>
					离床状态
				</th>
				<th>
					时间
				</th>
			</tr>
		</thead>
		<tbody>

			@if (Model.Item2 != null && Model.Item2.data != null)
			{
				@for (int i = 1; i <= Model.Item2.data.Count(); i++)
				{
					var item = Model.Item2.data.ToArray()[i - 1];

					DateTime time = item.createTime.ToDateTime("yyyy-MM-ddTHH:mm:ss");

					<tr>
						<td>
							@Html.DisplayFor(modelItem => i)
						</td>
						<td>
							@Html.DisplayFor(modelItem => item.heartBeat)
						</td>
						<td>
							@Html.DisplayFor(modelItem => item.breath)
						</td>
						<td>
							@if (item.state == "mov")
							{
								<input value="True" type="checkbox" />
							}
							else
							{
								<input value="false" type="checkbox" />
							}

						</td>
						<td>
							@*@Html.DisplayFor(modelItem => item.Sleep)*@
							@if (Model.Item2.result == null || Model.Item2.result.sleepResult == null)
							{
								<b>不详</b>
							}
							else
							{
								@if (Model.Item2.result.sleepResult.GoToSleep != null && Model.Item2.result.sleepResult.GoToSleep.sleepRecords != null && Model.Item2.result.sleepResult.GoToSleep.sleepRecords.Exists(l => time > l.StartTime && time < l.EndTime))
								{
									<b>入睡阶段</b>
								}
								else if (Model.Item2.result.sleepResult.LightSleep != null && Model.Item2.result.sleepResult.LightSleep.sleepRecords != null && Model.Item2.result.sleepResult.LightSleep.sleepRecords.Exists(l => time >= l.StartTime && time <= l.EndTime))
								{
									<b>浅睡阶段</b>
								}
								else if (Model.Item2.result.sleepResult.DeepSleep != null && Model.Item2.result.sleepResult.DeepSleep.sleepRecords != null && Model.Item2.result.sleepResult.DeepSleep.sleepRecords.Exists(l => time > l.StartTime && time < l.EndTime))
								{
									<b>深睡阶段</b>
								}
								else
								{
									<b>未睡眠</b>
								}
							}

						</td>
						<td>
							@if (item.state == "off")
							{
								<input value="True" type="checkbox" />
							}
							else
							{
								<input value="false" type="checkbox" />
							}
						</td>
						<td>
							@Html.DisplayFor(modelItem => item.createTime)
						</td>
					</tr>
				}
			}
		</tbody>
	</table>
</div>


<script>
	function init_DataTables() {

		console.log('run_datatables');

		if (typeof ($.fn.DataTable) === 'undefined') { return; }
		console.log('init_DataTables');

		var handleDataTableButtons = function () {
			if ($("#datatable-buttons").length) {
				$("#datatable-buttons").DataTable({
					dom: "Blfrtip",
					buttons: [
						{
							extend: "copy",
							className: "btn-sm ",
							text: "复制数据"
						},
						{
							extend: "csv",
							className: "btn-sm",
							text: "导出CSV"
						},
						{
							extend: "excel",
							className: "btn-sm",
							text: "导出Excel"
						}, 
						{
							extend: "pdfHtml5",
							className: "btn-sm",
							text: "导出PDF"
						},
						{
							extend: "print",
							className: "btn-sm",
							text: "打印表格"
						},
					],
					responsive: true
				});
			}
		};

		TableManageButtons = function () {
			"use strict";
			return {
				init: function () {
					handleDataTableButtons();
				}
			};
		}();

		$('#datatable').dataTable();

		$('#datatable-keytable').DataTable({
			keys: true
		});

		$('#datatable-responsive').DataTable();

		$('#datatable-scroller').DataTable({
			ajax: "js/datatables/json/scroller-demo.json",
			deferRender: true,
			scrollY: 380,
			scrollCollapse: true,
			scroller: true
		});

		$('#datatable-fixed-header').DataTable({
			fixedHeader: true
		});

		var $datatable = $('#datatable-checkbox');

		$datatable.dataTable({
			'order': [[1, 'asc']],
			'columnDefs': [
				{ orderable: false, targets: [0] }
			]
		});
		$datatable.on('draw.dt', function () {
			$('checkbox input').iCheck({
				checkboxClass: 'icheckbox_flat-green'
			});
		});

		TableManageButtons.init();

	};

	init_DataTables();
</script>

